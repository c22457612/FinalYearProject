<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Visual Privacy Toolkit – Control Centre</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <div class="header-left">
      <h1>Visual Privacy Toolkit – Control Centre</h1>
      <span class="header-subtitle">Prototype live view (local only, no cloud)</span>
    </div>
    <div id="connectionStatus" class="badge">Connecting…</div>
  </header>

  <div class="app-shell">
    <!-- Sidebar navigation -->
    <aside class="sidebar">
      <div class="sidebar-title">Sections</div>
      <button class="nav-item active" data-view="home">Home</button>
      <button class="nav-item" data-view="cookies">Cookies</button>
    </aside>

    <!-- Main content area (views switch inside here) -->
    <div class="app-content">
      <!-- HOME VIEW: existing dashboard -->
      <main id="view-home">
        <section>
          <div class="summary">
            <div class="summary-card">
              <h2>Total events</h2>
              <div id="statTotalEvents" class="value">0</div>
              <div class="hint">since server started</div>
            </div>
            <div class="summary-card">
              <h2>Active sites</h2>
              <div id="statSites" class="value">0</div>
              <div class="hint">seen in recent events</div>
            </div>
            <div class="summary-card">
              <h2>Events (last 5 min)</h2>
              <div id="statRecent" class="value">0</div>
              <div class="hint" id="statRecentHint">refreshing…</div>
            </div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <div>
                <div class="panel-title">Live Privacy Receipt</div>
                <div class="panel-subtitle" id="receiptSubtitle">
                  Showing latest events…
                </div>
              </div>
            </div>
            <div class="scroll">
              <table>
                <thead>
                  <tr>
                    <th>Time</th>
                    <th>Site</th>
                    <th>Event</th>
                    <th>Details</th>
                    <th>Mode</th>
                  </tr>
                </thead>
                <tbody id="eventsTableBody"></tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- RIGHT COLUMN: per-site summary + event details -->
        <section class="right-column">
          <!-- Per-site summary -->
          <div class="panel">
            <div class="panel-header">
              <div>
                <div class="panel-title">Per-site summary</div>
                <div class="panel-subtitle">
                  Derived from current in-memory stats
                </div>
              </div>
            </div>

            <div class="table-wrapper">
              <table class="summary-table">
                <thead>
                  <tr>
                    <th>Site</th>
                    <th>Events</th>
                    <th>Blocked</th>
                    <th>Observed</th>
                    <th>3rd-party domains</th>
                  </tr>
                </thead>
                <tbody id="site-summary-body">
                  <!-- filled by dashboard.js -->
                </tbody>
              </table>
            </div>
          </div>

          <!-- Event details panel -->
          <div class="panel details-panel">
            <div class="panel-header">
              <div>
                <div class="panel-title">Event details</div>
                <div id="details-subtitle" class="panel-subtitle">
                  Click an event in the table to see more information.
                </div>
              </div>
            </div>

            <div id="details-body" class="details-body">
              <div class="details-placeholder">No event selected.</div>
            </div>

            <div id="details-actions" class="details-actions">
              <button id="trust-site-btn">
                Trust this site (send to extension)
              </button>
            </div>


            <button id="details-json-toggle" class="details-json-toggle" hidden>
              Show raw event JSON
            </button>
            <pre id="details-json" class="details-json" hidden></pre>
          </div>
        </section>
      </main>

      <!-- COOKIES VIEW: placeholder for now -->
      <main id="view-cookies" class="cookies-view hidden">
        <section class="panel cookies-placeholder">
          <div class="panel-header">
            <div>
              <div class="panel-title">Cookies overview</div>
              <div class="panel-subtitle">
                Cookie snapshots from the browser extension will appear here.
              </div>
            </div>
          </div>
          <div class="panel-body">
            <p>
              In Phase&nbsp;1 this view is read-only. The extension will send
              cookie snapshots per site, and the Control Centre will aggregate
              them into a “wall of cookies” for exploration.
            </p>
          </div>
        </section>
      </main>

      <footer>
        <div>Prototype only: data resets when the backend restarts.</div>
        <div>Source: local extension events streamed to
          <code>http://127.0.0.1:4141</code>.
        </div>
      </footer>
    </div>
  </div>

  <script src="dashboard.js" defer></script>
</body>
</html>
